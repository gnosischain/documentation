"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[58777],{94808:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>b,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var s=n(74848),i=n(28453);const r={title:"Debugging Transactions",description:"Developer guide on how to debug bridge transactions",keywords:["amb debug","developer","debugging transactions","bridge transactions"]},d="Debugging OmniBridge Transactions",o={id:"bridges/tutorials/using-omnibridge/debugging-omnibridge-txns",title:"Debugging Transactions",description:"Developer guide on how to debug bridge transactions",source:"@site/docs/bridges/tutorials/using-omnibridge/debugging-omnibridge-txns.md",sourceDirName:"bridges/tutorials/using-omnibridge",slug:"/bridges/tutorials/using-omnibridge/debugging-omnibridge-txns",permalink:"/bridges/tutorials/using-omnibridge/debugging-omnibridge-txns",draft:!1,unlisted:!1,editUrl:"https://github.com/gnosischain/documentation/tree/main/docs/bridges/tutorials/using-omnibridge/debugging-omnibridge-txns.md",tags:[],version:"current",lastUpdatedBy:"zengzengzenghuy",lastUpdatedAt:1690538497,formattedLastUpdatedAt:"Jul 28, 2023",frontMatter:{title:"Debugging Transactions",description:"Developer guide on how to debug bridge transactions",keywords:["amb debug","developer","debugging transactions","bridge transactions"]},sidebar:"bridges",previous:{title:"Specific Tokens",permalink:"/bridges/tutorials/using-omnibridge/specific-tokens"},next:{title:"Safe App",permalink:"/bridges/tutorials/using-omnibridge/safe"}},a={},c=[];function g(e){const t={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"debugging-omnibridge-transactions",children:"Debugging OmniBridge Transactions"}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["This page is mostly for application developers, if you sent tokens through the OmniBridge and would like to get the status whether the tokens were sent successfully or not, please use ",(0,s.jsx)(t.a,{href:"https://alm-bridge-monitor.gnosischain.com/",children:"AMB Live Monitoring application"})," instead."]})}),"\n",(0,s.jsxs)(t.p,{children:["Firstly, the ",(0,s.jsx)(t.a,{href:"https://etherscan.io/address/0x4C36d2919e407f0Cc2Ee3c993ccF8ac26d9CE64e",children:"Foreign Arbitrary Message Bridge contract"})," which is used by the OmniBridge, emits the ",(0,s.jsx)(t.code,{children:"UserRequestForAffirmation"})," event as part of the a deposit request made by user (on the Ethereum side)."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"event UserRequestForAffirmation(bytes32 indexed messageId, bytes encodedData);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["For example, ",(0,s.jsx)(t.a,{href:"https://etherscan.io/tx/0x804a4b28520faad8b68d122cafdffedd2e185a9aa734b69f264a652d5c53afa4#eventlog",children:"this is the event in the OmniBridge transaction"}),", and the topic ",(0,s.jsx)(t.code,{children:"0x482515ce3d9494a37ce83f18b72b363449458435fafdd7a53ddea7460fe01b58"}),"\r\n",(0,s.jsx)(t.img,{src:n(80752).A+"",width:"756",height:"407"}),(0,s.jsx)(t.br,{}),"\n","In the event definition and from the example, the Id of the AMB message is trackable as part of the event. The event from the example shows the message Id: ",(0,s.jsx)(t.code,{children:"0x000500004ac82b41bd819dd871590b510316f2385cb196fb0000000000000402"}),".",(0,s.jsx)(t.br,{}),"\n","On the other side of the bridge, if the message was executed successfully the ",(0,s.jsx)(t.a,{href:"https://gnosis.blockscout.com/address/0x75Df5AF045d91108662D8080fD1FEFAd6aA0bb59",children:"AMB contract"})," emits the ",(0,s.jsx)(t.code,{children:"AffirmationCompleted"})," event."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"event AffirmationCompleted(\r\n    address indexed sender,\r\n    address indexed executor,\r\n    bytes32 indexed messageId,\r\n    bool status\r\n);\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Here is ",(0,s.jsx)(t.a,{href:"https://blockscout.com/xdai/mainnet/tx/0x092f1c8a02f305e5bfb671b923710cdd150c5b0e41df048c75b790538a25025b/logs",children:"the event corresponding to the example"}),(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.img,{src:n(52043).A+"",width:"1014",height:"542"}),"\r\nThe topic of the event is ",(0,s.jsx)(t.code,{children:"0xe194ef610f9150a2db4110b3db5116fd623175dca3528d7ae7046a1042f84fe7"}),". And the message Id is represented as a separate topic in the event.\r\nThat's why it is possible to use different ways to filter out the corresponding transaction if the message Id of the OmniBridge deposit is known (it always can be received from the deposit transaction).\r\nFor example, you can use the BlockScout API for this: ",(0,s.jsx)(t.a,{href:"https://docs.blockscout.com/for-users/api/rpc-endpoints",children:"https://docs.blockscout.com/for-users/api/rpc-endpoints"}),". Example of the request to the BlockScout:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"https://gnosis.blockscout.com/api?module=logs&action=getLogs&fromBlock=1&toBlock=latest&address=0x75Df5AF045d91108662D8080fD1FEFAd6aA0bb59&topic0=0xe194ef610f9150a2db4110b3db5116fd623175dca3528d7ae7046a1042f84fe7&topic3=0x000500004ac82b41bd819dd871590b510316f2385cb196fb0000000000000402&topic0_3_opr=and\n"})}),"\n",(0,s.jsxs)(t.p,{children:["It will return the JSON with the transaction hash correlated to the emission of the event ",(0,s.jsx)(t.code,{children:"AffirmationCompleted"})," with the message Id:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'{\r\n  "message": "OK",\r\n  "result": [\r\n    {\r\n      "address": "0x75df5af045d91108662d8080fd1fefad6aa0bb59",\r\n      "blockNumber": "0xbc8133",\r\n      "data": "0x0000000000000000000000000000000000000000000000000000000000000001",\r\n      "gasPrice": "0x3b9aca00",\r\n      "gasUsed": "0x2d572",\r\n      "logIndex": "0x8",\r\n      "timeStamp": "0x5f7ab6dd",\r\n      "topics": [\r\n        "0xe194ef610f9150a2db4110b3db5116fd623175dca3528d7ae7046a1042f84fe7",\r\n        "0x00000000000000000000000088ad09518695c6c3712ac10a214be5109a655671",\r\n        "0x000000000000000000000000f6a78083ca3e2a662d6dd1703c939c8ace2e268d",\r\n        "0x000500004ac82b41bd819dd871590b510316f2385cb196fb0000000000000402"\r\n      ],\r\n      "transactionHash": "0x092f1c8a02f305e5bfb671b923710cdd150c5b0e41df048c75b790538a25025b",\r\n      "transactionIndex": "0x5"\r\n    }\r\n  ],\r\n  "status": "1"\r\n}\n'})})]})}function b(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},80752:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/omni-debugging1-576e811726a3f0e9e7c46f43430d1af1.png"},52043:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/omni-debugging2-a8ca1e57aee3433e7ea0f8a4e808c166.png"},28453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>o});var s=n(96540);const i={},r=s.createContext(i);function d(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);