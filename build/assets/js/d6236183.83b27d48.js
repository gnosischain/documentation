"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[96844],{1543:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var i=t(74848),s=t(28453);const r={description:"Set an alternate receiver when bridging tokens to and from Gnosis using the xdai bridge.",keywords:["xdai bridge","alternate receiver","gnosis bridge"]},a="Alternate Receiver",o={id:"bridges/tutorials/using-xdai-bridge/alternate-receiver",title:"Alternate Receiver",description:"Set an alternate receiver when bridging tokens to and from Gnosis using the xdai bridge.",source:"@site/docs/bridges/tutorials/using-xdai-bridge/alternate-receiver.md",sourceDirName:"bridges/tutorials/using-xdai-bridge",slug:"/bridges/tutorials/using-xdai-bridge/alternate-receiver",permalink:"/bridges/tutorials/using-xdai-bridge/alternate-receiver",draft:!1,unlisted:!1,editUrl:"https://github.com/gnosischain/documentation/tree/main/docs/bridges/tutorials/using-xdai-bridge/alternate-receiver.md",tags:[],version:"current",lastUpdatedBy:"zengzengzenghuy",lastUpdatedAt:1690538497,formattedLastUpdatedAt:"Jul 28, 2023",frontMatter:{description:"Set an alternate receiver when bridging tokens to and from Gnosis using the xdai bridge.",keywords:["xdai bridge","alternate receiver","gnosis bridge"]},sidebar:"bridges",previous:{title:"Safe App",permalink:"/bridges/tutorials/using-xdai-bridge/safe"},next:{title:"Custom RPC",permalink:"/bridges/tutorials/using-xdai-bridge/custom-rpc"}},d={},c=[{value:"Dai to xDai",id:"dai-to-xdai",level:2},{value:"xDai to Dai",id:"xdai-to-dai",level:2},{value:"Dai to xDai (Manual, Non-UI Method)",id:"dai-to-xdai-manual-non-ui-method",level:2},{value:"xDai to Dai (Non-UI Method)",id:"xdai-to-dai-non-ui-method",level:2}];function l(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"alternate-receiver",children:"Alternate Receiver"}),"\n",(0,i.jsxs)(n.p,{children:["The feature ",(0,i.jsx)(n.em,{children:"Alternative Receiver"})," has integrated in the contracts of the xDai bridge as part of ",(0,i.jsx)(n.a,{href:"https://forum.poa.network/t/migration-of-the-xdai-tokenbridge-completed/3212",children:"an upgrade"}),". With this feature it becomes possible to transfer tokens through the bridge to any account by very simple actions. It means that Alice can send Dai to Bob\u2019s account on Gnosis chain in one transaction, and Bob can send xDai to Clare\u2019s account on the Ethereum Mainnet in one transaction too."]}),"\n",(0,i.jsx)(n.p,{children:"Due to different nature of tokens on two sides of the xDai bridge the operations to transfer assets to an alternative receiver from one chain to another differ as well."}),"\n",(0,i.jsxs)(n.p,{children:["The xDai Bridge Alternative Receiver functionality. The transfer requires 2 transactions, one to unlock the contract and a second to process the transaction. ",(0,i.jsx)(n.em,{children:"Manual methods are described below this section."})]}),"\n",(0,i.jsx)(n.h2,{id:"dai-to-xdai",children:"Dai to xDai"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.a,{href:"https://bridge.gnosischain.com/",children:"the bridge UI"})," and connect your MetaMask Wallet."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(75601).A+"",width:"2916",height:"1585"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Determine ",(0,i.jsx)(n.strong,{children:"Single Tx Unlock"})," or ",(0,i.jsx)(n.strong,{children:"Infinite Tx Unlock"}),". You may want to approve the transfer for a single transaction, or approve the contract to make unlimited transfers from this address to many other addresses. For a Single TX Unlock, proceed directly to step 3 below. For infinite TX unlock, complete the following."]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Go to Settings"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(45434).A+"",width:"2828",height:"1511"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Toggle Infinite Unlock and save. Close the modal and proceed to step 3."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(63011).A+"",width:"2916",height:"1583"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Click on ",(0,i.jsx)(n.strong,{children:"Advanced"})," and add the Recipients Address and the amount to Dai to transfer to Gnosis. Press ",(0,i.jsx)(n.strong,{children:"Unlock."})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(13291).A+"",width:"640",height:"480"})}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Confirm the Unlock transaction in MetaMask."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Click to Transfer and Confirm the transaction."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Once the initial transaction is successful, you will see consecutive Transfer Pending notifications with:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"20 of 20 block confirmations....."}),"\n",(0,i.jsx)(n.li,{children:"Countdown with continue until 1 block confirmation is left."}),"\n",(0,i.jsx)(n.li,{children:"Waiting for execution on Gnosis side."}),"\n",(0,i.jsx)(n.li,{children:"Transfer Complete."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"The transfer is complete. Check the balance of the new account by clicking on the BlockScout link or accessing the address on Gnosis Chain."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"xdai-to-dai",children:"xDai to Dai"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"With xDai to Dai transfers you do not need to use the Unlock feature. Connect to Gnosis Chain in MetaMask."}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Click on Advanced."}),"\n",(0,i.jsx)(n.li,{children:"Enter the Address that will receive Dai."}),"\n",(0,i.jsx)(n.li,{children:"Enter Amount."}),"\n",(0,i.jsx)(n.li,{children:"Click Request."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:t(92591).A+"",width:"2916",height:"1818"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Click Confirm to acknowledge you will need to perform 2 transactions."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Confirm the first tx in MetaMask."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Wait for 20 Block Confirmations on xDai."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Switch to ",(0,i.jsx)(n.strong,{children:"Ethereum Mainnet"})," in MetaMask. The Claim button will appear. Click ",(0,i.jsx)(n.strong,{children:"Claim"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Confirm"})," the second claim transaction in MetaMask. Once processed, the Dai should be available for the alternative receiver on Ethereum."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"dai-to-xdai-manual-non-ui-method",children:"Dai to xDai (Manual, Non-UI Method)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Open MetaMask and choose the Ethereum Mainnet."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the Dai Token Contract -> Write Contract functionality in Etherscan.\n",(0,i.jsx)(n.a,{href:"https://etherscan.io/address/0x6b175474e89094c44da98b954eedeac495271d0f#writeContract",children:"https://etherscan.io/address/0x6b175474e89094c44da98b954eedeac495271d0f#writeContract"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Connect to your Web3 Wallet (MetaMask)."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Approve the bridge contract to perform operations with tokens:"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"usr(address)"})," -- the address of the xDai bridge contract in the Ethereum Mainnet: ",(0,i.jsx)(n.code,{children:"0x4aa42145Aa6Ebf72e164C9bBC74fbD3788045016"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"wad(uint256)"})," -- the amount of tokens (in Wei) approved to send through the bridge (in this case 2 Dai): ",(0,i.jsx)(n.code,{children:"2000000000000000000"})]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Write"})]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Confirm the transaction in the MetaMask and wait until it is included in the chain."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Initialize the xDai bridge contract interface in Etherscan. Here you will write to the proxy contract. ",(0,i.jsx)(n.a,{href:"https://etherscan.io/address/0x4aa42145aa6ebf72e164c9bbc74fbd3788045016#writeProxyContract",children:"https://etherscan.io/address/0x4aa42145aa6ebf72e164c9bbc74fbd3788045016#writeProxyContract"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["You will see several ",(0,i.jsx)(n.code,{children:"relayTokens"})," methods. Use Method (1) to send to an alternate address. You can also use a second method (14) if the Dai deposit is performed by another contract of behalf of the user account (like a DEX). There are also 2 other ",(0,i.jsx)(n.code,{children:"relayToken"})," methods (4), (22) that specify a ",(0,i.jsx)(n.code,{children:"_token(address)"}),". These are not in use."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"relayTokens Method (1)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"_receiver (address)"})," - address of the alternate receiver, the account that will be sent native tokens on Gnosis chain"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"_amount (uint256)"})," - the amount of tokens (in Wei) to transfer; must be less or equal amount of tokens approved for the bridge operations"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Write"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"relayTokens Method(14)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"_sender (address)"})," - optional. Use when the Dai deposit is performed by another contract on behalf of a user account (e.g. by a DEX)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"_receiver (address)"})," - address of the alternate receiver, the account that will be sent native tokens on Gnosis chain"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"_amount (uint256)"})," - the amount of tokens (in Wei) to transfer; must be less or equal amount of tokens approved for the bridge operations"]}),"\n",(0,i.jsxs)(n.li,{children:["Click ",(0,i.jsx)(n.strong,{children:"Write"})]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"7",children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Submit the transaction in the MetaMask and wait until it is included in the chain."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["The xDai bridge will take some time to relay the deposit request to Gnosis chain. Once complete, the balance of the ",(0,i.jsx)(n.code,{children:"_receiver"}),"account will increase with the corresponding amount of xDai."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"xdai-to-dai-non-ui-method",children:"xDai to Dai (Non-UI Method)"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the ",(0,i.jsx)(n.a,{href:"https://gnosis.blockscout.com/address/0x7301CFA0e1756B71869E93d4e4Dca5c7d0eb0AA6?tab=write_proxy",children:"xDai bridge proxy contract on Gnosis Chain"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Using the ",(0,i.jsx)(n.code,{children:"relayTokens"}),' method under the "Write Proxy" tab, enter the receiver address in the ',(0,i.jsx)(n.code,{children:"_receiver"})," box, and the amount of xDai to transfer (in xDai - no need to convert to WEI). Connect your wallet and confirm the transaction. Copy the transaction hash.\n",(0,i.jsx)(n.img,{src:t(32399).A+"",width:"1668",height:"537"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Go to the ",(0,i.jsx)(n.a,{href:"https://gnosis.blockscout.com/address/0x2D51EAa266eafcb59bB36dD3c7E99C515e58113A?tab=write_proxy",children:"helper contract"}),". In the ",(0,i.jsx)(n.code,{children:"getMethodHash()"}),' method, enter the transaction hash from the previous step, the recipient address, and the amount being transferred. When entering the amount, you can use that little "+" icon to add the zeroes, as the amount needs to be entered in wei. Use the 10^18 option to save yourself some typing. Do not include any fees, only the amount to send. Copy the message hash after clicking query.\n',(0,i.jsx)(n.img,{src:t(17288).A+"",width:"1417",height:"322"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Paste the message hash from the previous step into the ",(0,i.jsx)(n.code,{children:"getMessage()"})," method. If you receive 0x0 it means either the bridge oracles did not send a confirmation for the withdrawal yet or the data entered in the step 3 is incorrect. Double check the info and if it is correct you will eventually receive the message.\n",(0,i.jsx)(n.img,{src:t(31244).A+"",width:"1417",height:"363"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Once you receive the message, use the message hash from step 3 and query the ",(0,i.jsx)(n.code,{children:"getSignatures()"})," method with it. It should return a blob packed with the signatures provided by the validator. If enough signatures haven't been collected yet, then the query could fail. If this happens, waiting a few minutes should fix it.\n",(0,i.jsx)(n.img,{src:t(27918).A+"",width:"1167",height:"350"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Copy and paste the signature blob and the output from step 4 into the ",(0,i.jsx)(n.a,{href:"https://etherscan.io/address/0x4aa42145aa6ebf72e164c9bbc74fbd3788045016#writeProxyContract",children:"Ethereum proxy contract"}),"'s ",(0,i.jsx)(n.code,{children:"executeSignatures"})," method (you will need some Eth for gas). Connect your wallet and click write. After the transaction processes, the funds should appear in the receiver wallet.\n",(0,i.jsx)(n.img,{src:t(73209).A+"",width:"1331",height:"427"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/bridges/tutorials/using-xdai-bridge/alternate-receiver",children:"How to bridge Dai to a different address on Gnosis"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.tokenbridge.net/xdai-bridge/using-the-xdai-bridge/alternative-receiver-for-the-xdai-bridge",children:"TokenBridge Docs: Alternative Receiver for the xDai Bridge"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},73209:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xDai-manual-xDai-Dai-execSignatures-0ead6a065f5f9cfe557ee3e686a0f330.png"},31244:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xDai-manual-xDai-Dai-getMsg-15848fb366400ec117134f9d24375119.png"},17288:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xDai-manual-xDai-Dai-getMsgHash-c01ebf6b61174b8c2929e1cdb2cd9447.png"},27918:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xDai-manual-xDai-Dai-getSignatures-8cdf1572ecd06a7e6d70a8e46c61d933.png"},32399:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xDai-manual-xDai-Dai1-3a9c6797135c7a792ba7be5d947252d4.png"},75601:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xdai-alt-rec-dai-xdai1-efe0fb3a247f6f686b670c8d4e10c854.png"},45434:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xdai-alt-rec-dai-xdai2-422f554e9958efece00c5af1cf8e3792.png"},63011:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xdai-alt-rec-dai-xdai3-8df7071c53e413a067a808fc4663b370.png"},13291:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xdai-alt-rec-dai-xdai4-c2719bd9866d795c7e3f26db8c5561e4.gif"},92591:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/xdai-alt-rec-xdai-dai1-026d8c50684c12ea9163347f5c37d142.png"},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var i=t(96540);const s={},r=i.createContext(s);function a(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);