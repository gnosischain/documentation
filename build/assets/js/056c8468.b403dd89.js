"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[78993],{16847:(e,n,t)=>{t.d(n,{Ay:()=>l});var r=t(74848),s=t(28453),o=t(49489),a=t(7227);function i(e){const n={code:"code",pre:"pre",...(0,s.R)(),...e.components};return(0,r.jsxs)(o.A,{children:[(0,r.jsx)(a.A,{value:"execution",label:"execution",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker logs -f --tail 500 execution\n"})})}),(0,r.jsx)(a.A,{value:"consensus",label:"consensus",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker logs -f --tail 500 consensus\n"})})}),(0,r.jsx)(a.A,{value:"validator",label:"validator",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"docker logs -f --tail 500 validator\n"})})})]})}function l(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}},25569:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var r=t(74848),s=t(28453),o=t(16847);const a={title:"Lodestar"},i="Run Validator: Lodestar",l={id:"node/manual/validator/run/lodestar",title:"Lodestar",description:"The Validator requires a Consensus Client (also known as Beacon Node) in order to operate. See Step 3: Run Beacon Node - Lodestar for more information.",source:"@site/docs/node/manual/validator/run/lodestar.md",sourceDirName:"node/manual/validator/run",slug:"/node/manual/validator/run/lodestar",permalink:"/node/manual/validator/run/lodestar",draft:!1,unlisted:!1,editUrl:"https://github.com/gnosischain/documentation/tree/main/docs/node/manual/validator/run/lodestar.md",tags:[],version:"current",lastUpdatedBy:"shuoer86",lastUpdatedAt:1698242087,formattedLastUpdatedAt:"Oct 25, 2023",frontMatter:{title:"Lodestar"},sidebar:"node",previous:{title:"Run Validator",permalink:"/node/manual/validator/run"},next:{title:"Teku",permalink:"/node/manual/validator/run/teku"}},d={},c=[{value:"Option 1: Run as System Process",id:"system-process",level:2},{value:"Option 2: Run using Docker",id:"docker",level:2},{value:"1. Folder Structure",id:"1-folder-structure",level:3},{value:"2. Docker Compose",id:"2-docker-compose",level:3},{value:"3. Environment Variables",id:"3-environment-variables",level:3},{value:"4. Keystore Location",id:"4-keystore-location",level:3},{value:"5. Import Keystores",id:"5-import-keystores",level:3},{value:"6. Start Containers",id:"6-start-containers",level:3},{value:"7. Monitor Logs",id:"7-monitor-logs",level:3},{value:"8. Make a Deposit",id:"8-make-a-deposit",level:3},{value:"9. Updating your Node",id:"9-updating-your-node",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"run-validator-lodestar",children:"Run Validator: Lodestar"}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.p,{children:["The Validator requires a Consensus Client (also known as Beacon Node) in order to operate. See ",(0,r.jsx)(n.a,{href:"/node/manual/beacon/lodestar",children:"Step 3: Run Beacon Node - Lodestar"})," for more information."]})}),"\n",(0,r.jsx)(n.h2,{id:"system-process",children:"Option 1: Run as System Process"}),"\n",(0,r.jsxs)(n.p,{children:["Refer to ",(0,r.jsx)(n.a,{href:"/node/manual/#step-4-run-a-validator",children:"Guide"})]}),"\n",(0,r.jsx)(n.h2,{id:"docker",children:"Option 2: Run using Docker"}),"\n",(0,r.jsx)(n.h3,{id:"1-folder-structure",children:"1. Folder Structure"}),"\n",(0,r.jsx)(n.p,{children:"Create new folders:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"mkdir /home/$USER/gnosis/consensus/keystores\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"/home/$USER/gnosis/\n\u251c\u2500\u2500 jwtsecret/\n\u251c\u2500\u2500 execution/\n\u2514\u2500\u2500 consensus/\n    \u251c\u2500\u2500 data/\n    \u2514\u2500\u2500 keystores/\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-docker-compose",children:"2. Docker Compose"}),"\n",(0,r.jsxs)(n.p,{children:["Modify your docker-compose file with your favorite text editor and add the ",(0,r.jsx)(n.code,{children:"validator"})," container. You will also need to add the command ",(0,r.jsx)(n.code,{children:"--suggestedFeeRecipient=$FEE_RECIPIENT"})," to your ",(0,r.jsx)(n.code,{children:"consensus"})," container. The file should now look like:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="/home/$USER/gnosis/docker-compose.yml" showLineNumbers',children:'version: "3"\nservices:\n\n  execution:\n    # From Step 2\n    # ...\n\n  consensus:\n    # From Step 3\n    # ...\n\n// highlight-start\n  validator:\n    container_name: validator\n    image: chainsafe/lodestar:latest\n    restart: always\n    networks:\n      - gnosis_net\n    ports:\n      - 5064:5064/tcp\n    volumes:\n      - /home/$USER/gnosis/consensus/validators:/data/validators\n      - /home/$USER/gnosis/consensus/keystores:/keystores\n      - /etc/timezone:/etc/timezone:ro\n      - /etc/localtime:/etc/localtime:ro\n    environment:\n      - NODE_OPTIONS=--max-old-space-size=4096\n    command: |\n      validator\n      --network=gnosis\n      --dataDir=/data/validators\n      --logFile=/data/validators/logs/validator.log\n      --logFileLevel=info\n      --beaconNodes=http://consensus:4000\n      --metrics=true\n      --metrics.address=0.0.0.0\n      --metrics.port=5064\n      --suggestedFeeRecipient=$FEE_RECIPIENT\n      --graffiti=$GRAFFITI\n      --importKeystores=/keystores\n      --importKeystoresPassword=/keystores/password.txt\n    logging:\n      driver: "local"\n// highlight-end\n\nnetworks:\n  gnosis_net:\n    name: gnosis_net\n'})}),"\n",(0,r.jsx)(n.h3,{id:"3-environment-variables",children:"3. Environment Variables"}),"\n",(0,r.jsxs)(n.p,{children:["Add an ",(0,r.jsx)(n.code,{children:".env"})," file with your fee recipient (your Gnosis address) and graffiti in ",(0,r.jsx)(n.code,{children:"/home/$USER/gnosis/.env"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",metastring:'title="/home/$USER/gnosis/.env"',children:"FEE_RECIPIENT=0x0000000000000000000000000000000000000000\nGRAFFITI=gnosischain/lodestar\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"suggestedFeeRecipient"})," with your Gnosis address. This fee recipient address will receive tips from user transactions from the block the validator proposed. If not set, the tips will be sent to zero address, that is burnt competely. It is strongly recommended that you configure this value in your setup.\nLearn more about ",(0,r.jsx)(n.a,{href:"https://chainsafe.github.io/lodestar/usage/validator-management/#configuring-the-fee-recipient-address",children:"suggestedFeeRecipient"})," flag in Lodestar docs."]}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"graffiti"})," with your own ",(0,r.jsx)(n.a,{href:"https://chainsafe.github.io/lodestar/reference/cli/",children:"graffiti"}),". It is an optional field that can be used to add a message to the ",(0,r.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/blocks/",children:"block"})," by the proposer."]}),"\n",(0,r.jsx)(n.h3,{id:"4-keystore-location",children:"4. Keystore Location"}),"\n",(0,r.jsxs)(n.p,{children:["Add your keystores in ",(0,r.jsx)(n.code,{children:"/home/$USER/gnosis/consensus/keystores/"})," and their password in a file ",(0,r.jsx)(n.code,{children:"/home/$USER/gnosis/consensus/keystores/password.txt"})," to get this file structure:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"/home/$USER/gnosis/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 .env\n\u251c\u2500\u2500 jwtsecret/\n\u251c\u2500\u2500 execution/\n\u2514\u2500\u2500 consensus/\n    \u251c\u2500\u2500 data/\n# highlight-start\n    \u2514\u2500\u2500 keystores/\n     \xa0\xa0 \u251c\u2500\u2500 keystore-001.json\n      \xa0\xa0\u251c\u2500\u2500 keystore-002.json\n     \xa0\xa0 \u2514\u2500\u2500 password.txt\n# highlight-end\n"})}),"\n",(0,r.jsx)(n.h3,{id:"5-import-keystores",children:"5. Import Keystores"}),"\n",(0,r.jsx)(n.p,{children:"Import your validators:"}),"\n",(0,r.jsxs)(n.p,{children:["When the Lodestar ",(0,r.jsx)(n.code,{children:"validator"})," container starts, it will search the directories for the keystores and password, and import them automatically."]}),"\n",(0,r.jsx)(n.h3,{id:"6-start-containers",children:"6. Start Containers"}),"\n",(0,r.jsx)(n.p,{children:"Start the validator service listed in the compose file:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"cd /home/$USER/gnosis\ndocker-compose up -d\n"})}),"\n",(0,r.jsx)(n.h3,{id:"7-monitor-logs",children:"7. Monitor Logs"}),"\n",(0,r.jsxs)(n.p,{children:["Check your logs for each service (",(0,r.jsx)(n.code,{children:"execution"}),", ",(0,r.jsx)(n.code,{children:"consensus"}),", or ",(0,r.jsx)(n.code,{children:"validator"}),") with:"]}),"\n","\n","\n",(0,r.jsx)(o.Ay,{}),"\n",(0,r.jsx)(n.h3,{id:"8-make-a-deposit",children:"8. Make a Deposit"}),"\n",(0,r.jsx)(n.p,{children:"Make deposit once your node is fully synced (this can take a few hours depending on setup)."}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"At this stage you should have your EL and CL fully synced and validators must be imported to your CL."})})}),"\n",(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"/node/manual/validator/deposit",children:"Validator Deposits"})," section."]}),"\n",(0,r.jsx)(n.h3,{id:"9-updating-your-node",children:"9. Updating your Node"}),"\n",(0,r.jsx)(n.p,{children:"To update, just pull the new images, then stop and restart your docker-compose file:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"cd /home/$USER/gnosis\ndocker-compose pull\ndocker-compose stop\ndocker-compose up -d\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},7227:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var r=t(18215);const s={tabItem:"tabItem_Ymn6"};var o=t(74848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,o.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,a),hidden:t,children:n})}},49489:(e,n,t)=>{t.d(n,{A:()=>k});var r=t(96540),s=t(18215),o=t(24245),a=t(56347),i=t(36494),l=t(62814),d=t(45167),c=t(81269);function u(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:s}}=e;return{value:n,label:t,attributes:r,default:s}}))}(t);return function(e){const n=(0,d.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const s=(0,a.W6)(),o=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(s.location.search);n.set(o,e),s.replace({...s.location,search:n.toString()})}),[o,s])]}function g(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,o=h(e),[a,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:o}))),[d,u]=m({queryString:t,groupId:s}),[g,f]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,o]=(0,c.Dv)(t);return[s,(0,r.useCallback)((e=>{t&&o.set(e)}),[t,o])]}({groupId:s}),v=(()=>{const e=d??g;return p({value:e,tabValues:o})?e:null})();(0,i.A)((()=>{v&&l(v)}),[v]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,o]),tabValues:o}}var f=t(11062);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(74848);function j(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,o.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),s=i[t].value;s!==r&&(d(n),a(s))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:i.map((e=>{let{value:n,label:t,attributes:o}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>l.push(e),onKeyDown:u,onClick:c,...o,className:(0,s.A)("tabs__item",v.tabItem,o?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function y(e){let{lazy:n,children:t,selectedValue:s}=e;const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function b(e){const n=g(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",v.tabList),children:[(0,x.jsx)(j,{...e,...n}),(0,x.jsx)(y,{...e,...n})]})}function k(e){const n=(0,f.A)();return(0,x.jsx)(b,{...e,children:u(e.children)},String(n))}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(96540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);