"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[785],{60810:(e,r,i)=>{i.r(r),i.d(r,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>c});var n=i(74848),s=i(28453);const t={title:"Arbitrary Message Bridge",description:"How to use the Arbitrary Message Bridge",keywords:["amb bridge","arbitrary message bridge","using amb","bridge","gnosis bridge"]},d=void 0,o={id:"bridges/tokenbridge/amb-bridge",title:"Arbitrary Message Bridge",description:"How to use the Arbitrary Message Bridge",source:"@site/docs/bridges/tokenbridge/amb-bridge.md",sourceDirName:"bridges/tokenbridge",slug:"/bridges/tokenbridge/amb-bridge",permalink:"/bridges/tokenbridge/amb-bridge",draft:!1,unlisted:!1,editUrl:"https://github.com/gnosischain/documentation/tree/main/docs/bridges/tokenbridge/amb-bridge.md",tags:[],version:"current",lastUpdatedBy:"Vanshika",lastUpdatedAt:1708167281,formattedLastUpdatedAt:"Feb 17, 2024",frontMatter:{title:"Arbitrary Message Bridge",description:"How to use the Arbitrary Message Bridge",keywords:["amb bridge","arbitrary message bridge","using amb","bridge","gnosis bridge"]},sidebar:"bridges",previous:{title:"Introduction",permalink:"/bridges/hashi/"},next:{title:"xDai Bridge",permalink:"/bridges/tokenbridge/xdai-bridge"}},a={},c=[{value:"Key Information",id:"key-information",level:2},{value:"Overview",id:"overview",level:3},{value:"Fees &amp; Daily Limits",id:"fees--daily-limits",level:3},{value:"Bridge Validators",id:"bridge-validators",level:3},{value:"Current Bridge Validators",id:"current-bridge-validators",level:3},{value:"Bridge Governance",id:"bridge-governance",level:3},{value:"Key Contracts",id:"key-contracts",level:2},{value:"Ethereum",id:"ethereum",level:3},{value:"Gnosis",id:"gnosis",level:3},{value:"Goerli",id:"goerli",level:3},{value:"Chiado",id:"chiado",level:3},{value:"How it works",id:"how-it-works",level:2},{value:"Terminology",id:"terminology",level:3},{value:"Call a cross-chain method via AMB:",id:"call-a-cross-chain-method-via-amb",level:3},{value:"Foreign Network to Home Network",id:"foreign-network-to-home-network",level:4},{value:"Home Network to Foreign Network",id:"home-network-to-foreign-network",level:4},{value:"How it works with Telepathy validator",id:"how-it-works-with-telepathy-validator",level:3},{value:"How to check if AMB is down (not relaying message)",id:"how-to-check-if-amb-is-down-not-relaying-message",level:3},{value:"Security Considerations for Receiving a Call",id:"security-considerations-for-receiving-a-call",level:3},{value:"Mediator Contracts",id:"mediator-contracts",level:3},{value:"AMB Components",id:"amb-components",level:3},{value:"Uses of AMB",id:"uses-of-amb",level:3},{value:"Managing Bridge Contracts",id:"managing-bridge-contracts",level:2},{value:"Bridge Roles",id:"bridge-roles",level:3},{value:"Managing Bridge Validators",id:"managing-bridge-validators",level:2},{value:"Resources",id:"resources",level:2}];function l(e){const r={a:"a",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components},{TabItem:t,Tabs:d}=r;return t||x("TabItem",!0),d||x("Tabs",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{src:i(27333).A+""})}),"\n",(0,n.jsx)(r.p,{children:"You can also send arbitrary data between Gnosis and Ethereum using the native Arbitrary Message Bridge (AMB). This allows Gnosis contracts to send data and trigger contract functions on Ethereum and other chains, and vice versa."}),"\n",(0,n.jsxs)(r.p,{children:["The AMB is a key bridge primitive that is used inside higher-order bridges like the ",(0,n.jsx)(r.a,{href:"/bridges/tokenbridge/omnibridge",children:"Omnibridge native token bridge"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["The AMB currently supports Ethereum, and is part of the ",(0,n.jsx)(r.a,{href:"https://tokenbridge.net/",children:"Tokenbridge Architecture"}),". There may be additional EVM-based networks supported in the future."]}),"\n",(0,n.jsxs)(r.p,{children:["With ",(0,n.jsx)(r.a,{href:"/bridges/governance/decisions#add-telepathy-validator-in-the-amb",children:"Telepathy added as the 8th validator"}),", AMB bridge is now more secure with trustless zero-knowledge light client technology. Due to the light client finality requirements (at least 12mins on Ethereum), the transactions will take approx. 30mins to be signed by the bridge. However, users can still use 3rd party bridges (Jumper.exchange, Connext, Hop) without any impact. For more details, check out ",(0,n.jsx)(r.a,{href:"#how-it-works-with-telepathy-validator",children:"how AMB & Omnibridge works with Telepathy validator"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"key-information",children:"Key Information"}),"\n",(0,n.jsx)(r.h3,{id:"overview",children:"Overview"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{}),(0,n.jsx)(r.th,{children:"Detail"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Frontend URL"}),(0,n.jsx)(r.td,{children:"N/A"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Trust Model"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"#bridge-validators",children:"4-of-8 Validator Multisig"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Governance"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"#bridge-governance",children:"8-of-16 Multisig"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Governance Parameters"}),(0,n.jsx)(r.td,{})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Bug Bounty"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://immunefi.com/bounty/gnosischain/",children:"up to $2m"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Bug Reporting"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://immunefi.com/bounty/gnosischain/",children:"Immunefi"})})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"fees--daily-limits",children:"Fees & Daily Limits"}),"\n",(0,n.jsx)(r.p,{children:"As the Arbitrary Message Bridge is a message passing bridge, there are no fees or daily limits associated with it."}),"\n",(0,n.jsx)(r.h3,{id:"bridge-validators",children:"Bridge Validators"}),"\n",(0,n.jsx)(r.p,{children:"For a message/tokens to be relayed to another network, bridge validators need to affirm the transaction. Bridge validators are run by trusted members of the Gnosis community and ZK Light Client validator Telepathy."}),"\n",(0,n.jsx)(r.h3,{id:"current-bridge-validators",children:"Current Bridge Validators"}),"\n",(0,n.jsxs)(d,{groupId:"bridge-validators",children:[(0,n.jsx)(t,{value:"eth-gc",label:"Eth <-> Gnosis",children:(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"GC Address"}),(0,n.jsx)(r.th,{children:"Organization Name"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x459a3bd49f1ff109bc90b76125533699aaaaf9a6",children:"gno:0x459a3bd49f1ff109bc90b76125533699aaaaf9a6"})}),(0,n.jsx)(r.td,{children:"Protofire"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x105CD22eD3D089Bf5589C59b452f9dE0796Ca52d",children:"gno:0x105CD22eD3D089Bf5589C59b452f9dE0796Ca52d"})}),(0,n.jsx)(r.td,{children:"Giveth"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xfa98b60e02a61b6590f073cad56e68326652d094",children:"gno:0xfa98b60e02a61b6590f073cad56e68326652d094"})}),(0,n.jsx)(r.td,{children:"Karpatkey"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xbdc141c8d2343f33f40cb9edd601ccf460cd0dde",children:"gno:0xbdc141c8d2343f33f40cb9edd601ccf460cd0dde"})}),(0,n.jsx)(r.td,{children:"GnosisDAO"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x674c97db4ce6cac04a124d745979f3e4cba0e9f0",children:"gno:0x674c97db4ce6cac04a124d745979f3e4cba0e9f0"})}),(0,n.jsx)(r.td,{children:"Cow Protocol"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x258667E543C913264388B33328337257aF208a8f",children:"gno:0x258667E543C913264388B33328337257aF208a8f"})}),(0,n.jsx)(r.td,{children:"Gnosis Safe"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x90776017057b84bc47D7e7383b65C463C80a6cdd",children:"gno:0x90776017057b84bc47D7e7383b65C463C80a6cdd"})}),(0,n.jsx)(r.td,{children:"Gateway"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xfdbf5711f77b97ea7f1f812832884c7328a682ec",children:"gno:0xfdbf5711f77b97ea7f1f812832884c7328a682ec"})}),(0,n.jsx)(r.td,{children:"Telepathy"})]})]})]})}),(0,n.jsx)(t,{value:"goerli-chiado",label:"Goerli <-> Chiado",children:(0,n.jsx)(r.p,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xc9ADb79B8A6e7C6e90c765A3B4d16d81213c9D49",children:"0xc9ADb79B8A6e7C6e90c765A3B4d16d81213c9D49"})})})]}),"\n",(0,n.jsx)(r.h3,{id:"bridge-governance",children:"Bridge Governance"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["See ",(0,n.jsx)(r.a,{href:"/bridges/governance",children:"Bridge Governance"})]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"key-contracts",children:"Key Contracts"}),"\n",(0,n.jsx)(r.p,{children:"References:"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"/bridges/tokenbridge/amb-bridge#bridge-governance",children:"Bridge Governance Board"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"/bridges/tokenbridge/amb-bridge#fees--daily-limits",children:"Bridge Daily Limits"})}),"\n"]}),"\n",(0,n.jsxs)(d,{children:[(0,n.jsxs)(t,{value:"ethereum",label:"Ethereum",children:[(0,n.jsx)(r.h3,{id:"ethereum",children:"Ethereum"}),(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Contract"}),(0,n.jsx)(r.th,{children:"Address"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB/Omnibridge Multi-Token Mediator"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://etherscan.io/address/0x88ad09518695c6c3712AC10a214bE5109a655671#writeProxyContract",children:"0x88ad09518695c6c3712AC10a214bE5109a655671"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB Contract Proxy (Foreign)"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://etherscan.io/address/0x4C36d2919e407f0Cc2Ee3c993ccF8ac26d9CE64e#writeProxyContract",children:"0x4C36d2919e407f0Cc2Ee3c993ccF8ac26d9CE64e"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB/OmniBridge wETH Router Helper"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://etherscan.io/address/0xa6439ca0fcba1d0f80df0be6a17220fed9c9038a",children:"0xa6439Ca0FCbA1d0F80df0bE6A17220feD9c9038a"})})]})]})]})]}),(0,n.jsxs)(t,{value:"gnosis",label:"Gnosis",children:[(0,n.jsx)(r.h3,{id:"gnosis",children:"Gnosis"}),(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Contract"}),(0,n.jsx)(r.th,{children:"Address"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB/Omnibridge Multi-Token Mediator"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xf6A78083ca3e2a662D6dd1703c939c8aCE2e268d#writeProxyContract",children:"0xf6A78083ca3e2a662D6dd1703c939c8aCE2e268d"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB Contract Proxy (Home)"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x75Df5AF045d91108662D8080fD1FEFAd6aA0bb59#writeProxyContract",children:"0x75Df5AF045d91108662D8080fD1FEFAd6aA0bb59"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB Helper Contract"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x7d94ece17e81355326e3359115D4B02411825EdD#readContract",children:"0x7d94ece17e81355326e3359115D4B02411825EdD"})})]})]})]})]}),(0,n.jsxs)(t,{value:"goerli",label:"Goerli",children:[(0,n.jsx)(r.h3,{id:"goerli",children:"Goerli"}),(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Contract"}),(0,n.jsx)(r.th,{children:"Address"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"OmniBridge Mediator (Foreign)"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://goerli.etherscan.io/address/0x00147c84f13764dCDAbAF1cbAe622fa6f6839085",children:"0x00147c84f13764dCDAbAF1cbAe622fa6f6839085"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB Contract Proxy (Foreign)"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://goerli.etherscan.io/address/0x87A19d769D875964E9Cd41dDBfc397B2543764E6",children:"0x87A19d769D875964E9Cd41dDBfc397B2543764E6"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"GNO on Goerli"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://goerli.etherscan.io/address/0x7f477c3f03213970d939104cc436dc995cf615b5",children:"0x7f477c3f03213970d939104cc436dc995cf615b5"})})]})]})]})]}),(0,n.jsxs)(t,{value:"chiado",label:"Chiado",children:[(0,n.jsx)(r.h3,{id:"chiado",children:"Chiado"}),(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Contract"}),(0,n.jsx)(r.th,{children:"Address"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"OmniBridge Mediator (Home)"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosis-chiado.blockscout.com/address/0x09D549a48AC52F3f9945E7de6402c609c92aa2E1",children:"0x09D549a48AC52F3f9945E7de6402c609c92aa2E1"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"AMB Contract Proxy (Home)"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosis-chiado.blockscout.com/address/0x99Ca51a3534785ED619f46A79C7Ad65Fa8d85e7a",children:"0x99Ca51a3534785ED619f46A79C7Ad65Fa8d85e7a"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"GnosisBridge(GNO) on Chiado"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosis-chiado.blockscout.com/address/0x19C653Da7c37c66208fbfbE8908A5051B57b4C70",children:"0x19C653Da7c37c66208fbfbE8908A5051B57b4C70"})})]})]})]})]})]}),"\n",(0,n.jsx)(r.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,n.jsx)(r.h3,{id:"terminology",children:"Terminology"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Home (Native) Network"}),": Of the two networks being bridged between, the home or native network is the one with fast and inexpensive operations. All bridge operations to collect validator confirmations are performed on this side of the bridge."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Foreign Network"}),": Can be any EVM chain, generally it refers to Ethereum."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Originating Contract"}),": An arbitrary contract where the message originates, typically this is where the user interacts and requests for a function to be invoked on another network."]}),"\n"]}),"\n",(0,n.jsx)(r.h3,{id:"call-a-cross-chain-method-via-amb",children:"Call a cross-chain method via AMB:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-solidity",children:"function requireToPassMessage (address _contract,\n                                bytes _data,\n                                uint256 _gas) external;\n"})}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"param"}),(0,n.jsx)(r.th,{children:"details"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"_contract"}),(0,n.jsx)(r.td,{children:"address of contract on other network"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"_data"}),(0,n.jsx)(r.td,{children:"encoded bytes of the method selector and the params that will be called in the contract on the other side"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"_gas"}),(0,n.jsx)(r.td,{children:"gas to be provided in execution of the method call on the other side"})]})]})]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{src:i(2482).A+"",width:"1191",height:"671"})}),"\n",(0,n.jsx)(r.h4,{id:"foreign-network-to-home-network",children:"Foreign Network to Home Network"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["User calls ",(0,n.jsx)(r.code,{children:"foo()"})," on the originating contract"]}),"\n",(0,n.jsxs)(r.li,{children:["Originating contract calls ",(0,n.jsx)(r.code,{children:"requireToPassMessage()"})," on Foreign Bridge contract, and encodes ",(0,n.jsx)(r.code,{children:"foo()"}),", target address, and includes some tokens for gas."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"UserRequestForAffirmation"})," event is emitted, and listening validators relay the message to the Home side where signatures are collected"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.code,{children:"executeAffirmation()"})," is called on the Home Bridge contract by a validator once enough signatures are collected."]}),"\n",(0,n.jsxs)(r.li,{children:["Home bridge contract decodes the message and calls ",(0,n.jsx)(r.code,{children:"foo()"})," on the target contract."]}),"\n"]}),"\n",(0,n.jsx)(r.h4,{id:"home-network-to-foreign-network",children:"Home Network to Foreign Network"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["User calls ",(0,n.jsx)(r.code,{children:"foo()"})," on an originating contract"]}),"\n",(0,n.jsxs)(r.li,{children:["Originating contract calls ",(0,n.jsx)(r.code,{children:"requireToPassMessage()"})," on Home Bridge contract, and encodes ",(0,n.jsx)(r.code,{children:"foo()"}),", target address, and includes some tokens for gas."]}),"\n",(0,n.jsxs)(r.li,{children:["Signatures are collected from validators, and once enough are collected ",(0,n.jsx)(r.code,{children:"requireToConfirmMessage()"})," is called"]}),"\n",(0,n.jsxs)(r.li,{children:["Message is relayed to the Foreign Bridge contract, and ",(0,n.jsx)(r.code,{children:"executeSignatures()"})," is called"]}),"\n",(0,n.jsxs)(r.li,{children:["Foreign bridge contract decodes the message and calls ",(0,n.jsx)(r.code,{children:"foo()"})," on target contract"]}),"\n"]}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"https://etherscan.io/address/0x4C36d2919e407f0Cc2Ee3c993ccF8ac26d9CE64e#writeProxyContract",children:"AMB Bridge proxy contact on Ethereum"}),(0,n.jsx)(r.br,{}),"\n",(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x75Df5AF045d91108662D8080fD1FEFAd6aA0bb59#writeProxyContract",children:"AMB Bridge Proxy Contract in Gnosis"})]}),"\n",(0,n.jsx)(r.h3,{id:"how-it-works-with-telepathy-validator",children:"How it works with Telepathy validator"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.img,{alt:"AMB&amp;Omnibridge with Telepathy Validator",src:i(77280).A+"",width:"1858",height:"1048"})}),"\n",(0,n.jsxs)(r.p,{children:["** In the graph above, light green compoenents work as the same as ",(0,n.jsx)(r.a,{href:"#call-a-cross-chain-method-via-amb",children:"Call a cross-chain method via AMB"})," on the previous section."]}),"\n",(0,n.jsx)(r.p,{children:"There are 5 key components for Telepathy validator in AMB & Omnibridge:"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"Off chain"})}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsxs)(r.li,{children:["Telepathy Relayer: Provide merkle proof for ",(0,n.jsx)(r.strong,{children:"Telepathy PubSub"}),", that the ",(0,n.jsx)(r.code,{children:"userRequestForAffirmation"})," event was emitted on Ethereum."]}),"\n",(0,n.jsxs)(r.li,{children:["Telepathy Operator: For every ~12 mins (2 epoch in Ethereum), call ",(0,n.jsx)(r.strong,{children:"Telepathy Light Client"})," to update header."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:"On Gnosis Chain"})}),"\n",(0,n.jsxs)(r.ol,{start:"3",children:["\n",(0,n.jsx)(r.li,{children:"Telepathy PubSub: Verify the Merkle proof against the block header and publish the event."}),"\n",(0,n.jsx)(r.li,{children:"Telepathy Light Client: Generate a proof of consensus for block header and verify on-chain."}),"\n",(0,n.jsxs)(r.li,{children:["Telepathy Validator: Subscribe to ",(0,n.jsx)(r.code,{children:"UserRequestForAffirmation"})," event, and handle the published event by calling ",(0,n.jsx)(r.code,{children:"executeAffirmation()"})," on AMB."]}),"\n"]}),"\n",(0,n.jsx)(r.p,{children:"Once the user initiate cross-chain method via AMB on Ethereum, it will take ~12 mins for the transaction to get finalized in block and for Telepathy light client to obtain the block header information. Thus, user has to wait for approx. 30 mins for the message to get bridged to Gnosis Chain."}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Role"}),(0,n.jsx)(r.th,{children:"Address"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Telepathy PubSub"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xa96c29A4114B414543Bdc9be5616dE270b9e88ec",children:"0xa96c29A4114B414543Bdc9be5616dE270b9e88ec"})})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Telepathy Validator"}),(0,n.jsx)(r.td,{children:(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0xfdbf5711f77b97ea7f1f812832884c7328a682ec",children:"0xfDBf5711f77B97EA7F1f812832884c7328a682eC"})})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["For more details, check out ",(0,n.jsx)(r.a,{href:"https://hackmd.io/@wdyZgTm3RrOsm-rhXDXEHA/BJ_7ExKgn",children:"Telepathy Validator for Omnibridge"})," and ",(0,n.jsx)(r.a,{href:"https://docs.telepathy.xyz/",children:"https://docs.telepathy.xyz/"}),"."]}),"\n",(0,n.jsx)(r.h3,{id:"how-to-check-if-amb-is-down-not-relaying-message",children:"How to check if AMB is down (not relaying message)"}),"\n",(0,n.jsxs)(r.p,{children:["In certain circumstances, i.e. hardfork, AMB will be planned for downtime (not relaying message) to ensure security of the bridge. Planned downtime will be announced in public channel like Discord and Twitter, prior to the event.",(0,n.jsx)(r.br,{}),"\n","There is also another way to check whether the AMB is down or not by reading ",(0,n.jsx)(r.code,{children:"maxGasPerTx"})," value on AMB contract."]}),"\n",(0,n.jsxs)(r.p,{children:["In the current configuration, ",(0,n.jsx)(r.code,{children:"maxGasPerTx"})," is set to 4000000 on ",(0,n.jsx)(r.a,{href:"https://etherscan.io/address/0x4C36d2919e407f0Cc2Ee3c993ccF8ac26d9CE64e#readProxyContract",children:"Ethereum"})," and 2000000 on ",(0,n.jsx)(r.a,{href:"https://gnosisscan.io/address/0x75Df5AF045d91108662D8080fD1FEFAd6aA0bb59#readProxyContract",children:"Gnosis Chain"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["The AMB is down when ",(0,n.jsx)(r.code,{children:"maxGasPerTx"})," is set to 0, only by owner of the contract."]}),"\n",(0,n.jsxs)(r.p,{children:["By setting ",(0,n.jsx)(r.code,{children:"maxGasPerTx"})," to 0, the ",(0,n.jsxs)(r.a,{href:"https://github.com/gnosischain/tokenbridge-contracts/blob/master/contracts/upgradeable_contracts/arbitrary_message/MessageDelivery.sol#L40",children:["condition in ",(0,n.jsx)(r.code,{children:"_sendMessage()"})]})," will not pass, meaning, the bridge is down/stopped."]}),"\n",(0,n.jsx)(r.h3,{id:"security-considerations-for-receiving-a-call",children:"Security Considerations for Receiving a Call"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Concern"}),(0,n.jsx)(r.th,{children:"Remediation"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Authorization"}),(0,n.jsxs)(r.td,{children:["Check the address of invoking contract using ",(0,n.jsx)(r.code,{children:"messageSender()"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Authorization"}),(0,n.jsxs)(r.td,{children:["Check that ",(0,n.jsx)(r.code,{children:"msg.sender"})," is the address of the bridge contract"]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Replay Attack"}),(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.code,{children:"transactionHash()"})," allows for checking of a hash of the transaction that invoked the ",(0,n.jsx)(r.code,{children:"requireToPassMessage()"})," call. The invoking contract (in some cases, the mediator contract) is responsible for providing a ",(0,n.jsx)(r.em,{children:"unique sequence"})," (can be a nonce) as part of the ",(0,n.jsx)(r.code,{children:"_data"})," param in the ",(0,n.jsx)(r.code,{children:"requireToPassMessage()"})," function call"]})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"mediator-contracts",children:"Mediator Contracts"}),"\n",(0,n.jsxs)(r.p,{children:["A mediator contract is needed if there is an approval flow, such as when transferring an NFT or ERC-20 token. For a more in-depth explanation, see the ",(0,n.jsx)(r.a,{href:"omnibridge#mediator-contracts",children:"Omnibridge page"}),"."]}),"\n",(0,n.jsx)(r.h3,{id:"amb-components",children:"AMB Components"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Component"}),(0,n.jsx)(r.th,{children:"Description"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"System Contracts"}),(0,n.jsx)(r.td,{children:"AMB Implementation Contracts (Home Bridge and Foreign Bridge), Governance Multisigs, gas limit helpers, failed call management helpers (for when gas estimate was insufficient), and fee management helpers to collect fees"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"Oracles"}),(0,n.jsxs)(r.td,{children:["Containerized microservices that listen for on-chain events and send confirmations to relay messages. ",(0,n.jsx)(r.a,{href:"https://github.com/omni/tokenbridge/blob/master/oracle/README.md",children:"More on them here"}),"."]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"DevOps"}),(0,n.jsxs)(r.td,{children:[(0,n.jsx)(r.a,{href:"https://github.com/omni/tokenbridge/blob/master/monitor/README.md",children:"Bridge monitoring"}),", ",(0,n.jsx)(r.a,{href:"https://github.com/omni/tokenbridge/tree/master/alm",children:"ALM"}),", docker compose, ansible playbooks"]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:"dApp Contracts"}),(0,n.jsx)(r.td,{children:"extensions (pair mediator contracts on both sides of the AMB), such as the Omnibridge"})]})]})]}),"\n",(0,n.jsx)(r.h3,{id:"uses-of-amb",children:"Uses of AMB"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["ERC-to-ERC Bridges: ",(0,n.jsx)(r.code,{children:"AMB-ERC-TO-ERC"})," mode enables the transfer of ERC tokens to the Foreign Mediator, which will interact with Foreign AMB Bridge to mint wrapped ERC-667 tokens on the Home Network. Complimentarily, the mode enables the transfer ERC20 or ERC-667 tokens to the Home Mediator, which will interact with Home AMB Bridge to unlock ERC20 tokens on the Foreign network. This is used by the ",(0,n.jsx)(r.a,{href:"omnibridge",children:"Omnibridge"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:["ERC-to-Native Bridges: ",(0,n.jsx)(r.code,{children:"ERC-TO-NATIVE"})," mode enables the user to send ERC20 tokens to the Foreign Bridge and receive native coins from the Home Bridge Complimentarily, then can send native coins to the Home Bridge to unlock ERC20 tokens from the Foreign Bridge. The home network nodes must support a consensus engine that allows using a smart contract for block reward calculation. This mode is used by the ",(0,n.jsx)(r.a,{href:"xdai-bridge",children:"xDai Bridge"})]}),"\n",(0,n.jsxs)(r.li,{children:["Message Passing: ",(0,n.jsx)(r.code,{children:"ARBITRARY-MESSAGE"})," mode enables the capability to invoke a Home/Foreign Bridge contract to send a message that will be executed on the other Network. This can be an arbitrary contract method invocation."]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"managing-bridge-contracts",children:"Managing Bridge Contracts"}),"\n",(0,n.jsx)(r.h3,{id:"bridge-roles",children:"Bridge Roles"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Administrator"})," role (representation of a multisig contract):","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"add/remove validators"}),"\n",(0,n.jsx)(r.li,{children:"set daily limits on either direction"}),"\n",(0,n.jsx)(r.li,{children:"set maximum per transaction limit on both bridges"}),"\n",(0,n.jsx)(r.li,{children:"set minimum per transaction limit on both bridges"}),"\n",(0,n.jsx)(r.li,{children:"upgrade contracts in case of vulnerability"}),"\n",(0,n.jsx)(r.li,{children:"set minimum required signatures from validators in order to relay a user's transaction"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"Validator"})," role:","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"provide 100% uptime to relay transactions"}),"\n",(0,n.jsxs)(r.li,{children:["listen for ",(0,n.jsx)(r.code,{children:"UserRequestForSignature"})," events on Home Bridge and sign an approval to relay assets on Foreign network"]}),"\n",(0,n.jsxs)(r.li,{children:["listen for ",(0,n.jsx)(r.code,{children:"CollectedSignatures"})," events on Home Bridge. As soon as enough signatures are collected, transfer all collected signatures to the Foreign Bridge contract."]}),"\n",(0,n.jsxs)(r.li,{children:["listen for ",(0,n.jsx)(r.code,{children:"UserRequestForAffirmation"})," or ",(0,n.jsx)(r.code,{children:"Transfer"})," (depending on the bridge mode) events on the Foreign Bridge and send approval to Home Bridge to relay assets from Foreign Network to Home"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.strong,{children:"User"})," role:","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["sends assets to Bridge contracts:","\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:["in ",(0,n.jsx)(r.code,{children:"ERC-TO-NATIVE"})," mode: send ERC20 tokens to the Foreign Bridge to receive native coins from the Home Bridge, send native coins to the Home Bridge to unlock ERC20 tokens from the Foreign Bridge;"]}),"\n",(0,n.jsxs)(r.li,{children:["in ",(0,n.jsx)(r.code,{children:"ARBITRARY-MESSAGE"})," mode: Invoke Home/Foreign Bridge to send a message that will be executed on the other Network as an arbitrary contract method invocation;"]}),"\n",(0,n.jsxs)(r.li,{children:["in ",(0,n.jsx)(r.code,{children:"AMB-ERC-TO-ERC"})," mode: transfer ERC20 tokens to the Foreign Mediator which will interact with Foreign AMB Bridge to mint ERC20 tokens on the Home Network, and transfer ERC20 tokens to the Home Mediator which will interact with Home AMB Bridge to unlock ERC20 tokens on Foreign network."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"managing-bridge-validators",children:"Managing Bridge Validators"}),"\n",(0,n.jsxs)(r.p,{children:["Bridge admins can vote to add/remove validators. Read more about governance ",(0,n.jsx)(r.a,{href:"/bridges/governance/",children:"here"})]}),"\n",(0,n.jsx)(r.h2,{id:"resources",children:"Resources"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"https://docs.tokenbridge.net/amb-bridge/about-amb-bridge",children:"Arbitrary Message Bridge Documentation"})}),"\n",(0,n.jsx)(r.li,{children:(0,n.jsx)(r.a,{href:"https://docs.tokenbridge.net/eth-xdai-amb-bridge/multi-token-extension/extension-internals",children:"Diagrams illustrating how AMB Bridge works"})}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}function x(e,r){throw new Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},77280:(e,r,i)=>{i.d(r,{A:()=>n});const n=i.p+"assets/images/AMBValidators-5067498cdb8a20a32d85c8d3c96d20eb.png"},2482:(e,r,i)=>{i.d(r,{A:()=>n});const n=i.p+"assets/images/amb-bridge-contract-flow-5c9e306d71f1f6513874f0062cf3b673.png"},27333:(e,r,i)=>{i.d(r,{A:()=>n});const n=i.p+"assets/images/amb-bridge-789d87f68f0a2a1c909bc14a2a71856d.svg"},28453:(e,r,i)=>{i.d(r,{R:()=>d,x:()=>o});var n=i(96540);const s={},t=n.createContext(s);function d(e){const r=n.useContext(t);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),n.createElement(t.Provider,{value:r},e.children)}}}]);