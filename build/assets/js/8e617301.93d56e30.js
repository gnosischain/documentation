"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[16726],{282:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var r=t(74848),s=t(28453);const i={title:"Step 1: Configure Server"},o="Configure Server",l={id:"node/manual/configure-server",title:"Step 1: Configure Server",description:"We recommend the following steps to configure your server with sensible system and security defaults. We currently provide a guide for Ubuntu users, but the principles extend to whichever OS you intend to use.",source:"@site/docs/node/manual/configure-server.md",sourceDirName:"node/manual",slug:"/node/manual/configure-server",permalink:"/node/manual/configure-server",draft:!1,unlisted:!1,editUrl:"https://github.com/gnosischain/documentation/tree/main/docs/node/manual/configure-server.md",tags:[],version:"current",lastUpdatedBy:"4rgon4ut",lastUpdatedAt:1691603037,formattedLastUpdatedAt:"Aug 9, 2023",frontMatter:{title:"Step 1: Configure Server"},sidebar:"node",previous:{title:"Interactive Guide",permalink:"/node/manual/"},next:{title:"Step 2: Run Execution Client",permalink:"/node/manual/execution"}},a={},u=[{value:"Configure Server",id:"configure-server-1",level:2},{value:"Update Server",id:"update-server",level:3},{value:"Configure Timekeeping",id:"configure-timekeeping",level:3},{value:"Create JWT",id:"create-jwt",level:3},{value:"Set up Networking",id:"set-up-networking",level:2},{value:"Install UFW",id:"install-ufw",level:3},{value:"Apply UFW Defaults",id:"apply-ufw-defaults",level:3},{value:"(Optional) Deny or Allow SSH",id:"optional-deny-or-allow-ssh",level:3},{value:"Allow Execution Client Port 30303",id:"allow-execution-client-port-30303",level:3},{value:"Allow Consensus Client port 9000",id:"allow-consensus-client-port-9000",level:3},{value:"Enable Firewall",id:"enable-firewall",level:3},{value:"Advanced",id:"advanced",level:2},{value:"Increasing Swap Space",id:"increasing-swap-space",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"configure-server",children:"Configure Server"}),"\n",(0,r.jsx)(n.p,{children:"We recommend the following steps to configure your server with sensible system and security defaults. We currently provide a guide for Ubuntu users, but the principles extend to whichever OS you intend to use."}),"\n",(0,r.jsx)(n.h2,{id:"configure-server-1",children:"Configure Server"}),"\n",(0,r.jsx)(n.h3,{id:"update-server",children:"Update Server"}),"\n",(0,r.jsx)(n.p,{children:"Update Ubuntu with the latest software and security updates."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ sudo apt -y update && sudo apt -y upgrade\n$ sudo apt dist-upgrade && sudo apt autoremove\n$ sudo reboot\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configure-timekeeping",children:"Configure Timekeeping"}),"\n",(0,r.jsx)(n.p,{children:"Consensus Layer clients are very sensitive to time, and require accurate timekeeping for proper synchronization with the blockchain network."}),"\n",(0,r.jsxs)(n.p,{children:["For Ubuntu machines, we recommend using the ",(0,r.jsx)(n.a,{href:"https://ubuntu.com/server/docs/network-ntp",children:"NTP service"}),", which helps ensure system time is synchronized."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"## Check time and date\n$ timedatectl\n\n## Setup NTP service\n$ sudo timedatectl set-ntp on\n"})}),"\n",(0,r.jsx)(n.admonition,{title:"Recommended",type:"tip",children:(0,r.jsxs)(n.p,{children:["Some users recommend using ",(0,r.jsx)(n.a,{href:"https://chrony.tuxfamily.org/",children:"Chrony"})," as a ",(0,r.jsx)(n.a,{href:"https://ubuntu.com/blog/ubuntu-bionic-using-chrony-to-configure-ntp",children:"method of configuring NTP"})]})}),"\n",(0,r.jsx)(n.h3,{id:"create-jwt",children:"Create JWT"}),"\n",(0,r.jsx)(n.h2,{id:"set-up-networking",children:"Set up Networking"}),"\n",(0,r.jsxs)(n.p,{children:["Ubuntu ships with a ",(0,r.jsx)(n.a,{href:"https://wiki.ubuntu.com/UncomplicatedFirewall",children:"ufw firewall"})," that helps prevent unwanted connections to your server. As your server is connected to the public internet, this is very important as there will be adversaries that will port scan for vulnerabilities."]}),"\n",(0,r.jsx)(n.h3,{id:"install-ufw",children:"Install UFW"}),"\n",(0,r.jsxs)(n.p,{children:["Ubuntu should have ",(0,r.jsx)(n.code,{children:"ufw"})," installed, otherwise you can install it."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ sudo apt install ufw\n"})}),"\n",(0,r.jsx)(n.h3,{id:"apply-ufw-defaults",children:"Apply UFW Defaults"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ sudo ufw default deny incoming\n$ sudo ufw default allow outgoing\n"})}),"\n",(0,r.jsx)(n.h3,{id:"optional-deny-or-allow-ssh",children:"(Optional) Deny or Allow SSH"}),"\n",(0,r.jsx)(n.p,{children:"If you are hosting your node locally (i.e. homestaker), we highly recommend you deny the SSH Port 22, which is a very common attack vector."}),"\n",(0,r.jsx)(n.p,{children:"If you are hosting your node in the cloud, you will need to allow the SSH Port 22 to connect to your machine. Make sure to allow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"## Deny SSH\n$ sudo ufw deny 22/tcp\n\n## Allow SSH\n$ sudo ufw allow 22/tcp\n"})}),"\n",(0,r.jsx)(n.h3,{id:"allow-execution-client-port-30303",children:"Allow Execution Client Port 30303"}),"\n",(0,r.jsx)(n.p,{children:"The Execution Client uses port 30303 to communicate with Execution Layer network peers."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ sudo ufw allow 30303\n"})}),"\n",(0,r.jsx)(n.h3,{id:"allow-consensus-client-port-9000",children:"Allow Consensus Client port 9000"}),"\n",(0,r.jsxs)(n.p,{children:["Most Consensus Layer Clients use port ",(0,r.jsx)(n.code,{children:"9000"})," to communicate with the Consensus Layer network peers, with the exception of Prysm, which uses ports ",(0,r.jsx)(n.code,{children:"13000/TCP"})," and ",(0,r.jsx)(n.code,{children:"12000/UDP"})," instead."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"## Lighthouse, Nimbus, Teku, Lodestar\n$ sudo ufw allow 9000\n\n## Prysm\n$ sudo ufw allow 13000/tcp\n$ sudo ufw allow 12000/udp\n"})}),"\n",(0,r.jsx)(n.h3,{id:"enable-firewall",children:"Enable Firewall"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ sudo ufw enable\n$ sudo ufw status numbered\n"})}),"\n",(0,r.jsx)(n.h2,{id:"advanced",children:"Advanced"}),"\n",(0,r.jsx)(n.h3,{id:"increasing-swap-space",children:"Increasing Swap Space"}),"\n",(0,r.jsx)(n.p,{children:"Gnosis clients (e.g. Erigon) tend to use large amounts of memory when syncing or running, which may lead to out-of-memory errors. Advanced users can consider allocating swap space, which allows the system to store in-memory data on their hard drives."}),"\n",(0,r.jsx)(n.admonition,{title:"Read More",type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://someresat.medium.com/guide-to-staking-on-ethereum-ubuntu-lodestar-193a2553a161",children:"Step 5: Create a Swap Space of Somer Esat's Guide"})}),"\n"]})})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var r=t(96540);const s={},i=r.createContext(s);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);