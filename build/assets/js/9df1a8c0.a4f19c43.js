"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[24257],{16847:(e,n,s)=>{s.d(n,{Ay:()=>l});var t=s(74848),o=s(28453),r=s(49489),a=s(7227);function i(e){const n={code:"code",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(r.A,{children:[(0,t.jsx)(a.A,{value:"execution",label:"execution",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker logs -f --tail 500 execution\n"})})}),(0,t.jsx)(a.A,{value:"consensus",label:"consensus",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker logs -f --tail 500 consensus\n"})})}),(0,t.jsx)(a.A,{value:"validator",label:"validator",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker logs -f --tail 500 validator\n"})})})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(i,{...e})}):i(e)}},65239:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var t=s(74848),o=s(28453),r=s(16847);const a={title:"Lighthouse"},i="Run Validator: Lighthouse",l={id:"node/manual/validator/run/lighthouse",title:"Lighthouse",description:"The Validator requires a Consensus Client (also known as Beacon Node) in order to operate. See See Step 3: Run Beacon Node - Lighthouse for more information.",source:"@site/docs/node/manual/validator/run/lighthouse.md",sourceDirName:"node/manual/validator/run",slug:"/node/manual/validator/run/lighthouse",permalink:"/node/manual/validator/run/lighthouse",draft:!1,unlisted:!1,editUrl:"https://github.com/gnosischain/documentation/tree/main/docs/node/manual/validator/run/lighthouse.md",tags:[],version:"current",lastUpdatedBy:"shuoer86",lastUpdatedAt:1698242087,formattedLastUpdatedAt:"Oct 25, 2023",frontMatter:{title:"Lighthouse"},sidebar:"node",previous:{title:"Teku",permalink:"/node/manual/validator/run/teku"},next:{title:"Nimbus",permalink:"/node/manual/validator/run/nimbus"}},c={},d=[{value:"Option 1: Run as System Process",id:"system-process",level:2},{value:"Option 2: Run using Docker",id:"docker",level:2},{value:"1. Folder Structure",id:"1-folder-structure",level:3},{value:"2. Docker Compose",id:"2-docker-compose",level:3},{value:"3. Environment Variables",id:"3-environment-variables",level:3},{value:"4. Keystore Location",id:"4-keystore-location",level:3},{value:"5. Import Keystores",id:"5-import-keystores",level:3},{value:"6. Start Containers",id:"6-start-containers",level:3},{value:"7. Monitor Logs",id:"7-monitor-logs",level:3},{value:"8. Make a Deposit",id:"8-make-a-deposit",level:3},{value:"9. Updating your Node",id:"9-updating-your-node",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"run-validator-lighthouse",children:"Run Validator: Lighthouse"}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["The Validator requires a Consensus Client (also known as Beacon Node) in order to operate. See See ",(0,t.jsx)(n.a,{href:"/node/manual/beacon/lighthouse",children:"Step 3: Run Beacon Node - Lighthouse"})," for more information."]})}),"\n",(0,t.jsx)(n.h2,{id:"system-process",children:"Option 1: Run as System Process"}),"\n",(0,t.jsxs)(n.p,{children:["Refer to ",(0,t.jsx)(n.a,{href:"/node/manual/#step-4-run-a-validator",children:"Guide"})]}),"\n",(0,t.jsx)(n.h2,{id:"docker",children:"Option 2: Run using Docker"}),"\n",(0,t.jsx)(n.h3,{id:"1-folder-structure",children:"1. Folder Structure"}),"\n",(0,t.jsx)(n.p,{children:"Create new folders:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"mkdir /home/$USER/gnosis/consensus/keystores\nmkdir /home/$USER/gnosis/consensus/validators\n"})}),"\n",(0,t.jsx)(n.p,{children:"Including the folders from your Execution and Consensus clients, your folder structure should now look like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"/home/$USER/gnosis/\n\u251c\u2500\u2500 jwtsecret/\n\u251c\u2500\u2500 execution/\n\u2514\u2500\u2500 consensus/\n    \u251c\u2500\u2500 data/\n    \u251c\u2500\u2500 keystores/\n    \u2514\u2500\u2500 validators/\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-docker-compose",children:"2. Docker Compose"}),"\n",(0,t.jsxs)(n.p,{children:["Modify your docker-compose file with your favorite text editor and add the ",(0,t.jsx)(n.code,{children:"validator"})," container. You will also need to add the command ",(0,t.jsx)(n.code,{children:"--suggested-fee-recipient=$FEE_RECIPIENT"})," to your ",(0,t.jsx)(n.code,{children:"consensus"})," container. The file should now look like:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="/home/$USER/gnosis/docker-compose.yml" showLineNumbers',children:'version: "3"\nservices:\n\n  execution:\n    # From Step 2\n    # ...\n\n  consensus:\n    # From Step 3\n    # ...\n\n# highlight-start\n  validator:\n    container_name: validator\n    image: sigp/lighthouse:latest-modern\n    restart: always\n    command: |\n      lighthouse\n      validator_client\n      --network=gnosis\n      --datadir=/data/validators\n      --beacon-nodes=http://consensus:4000\n      --graffiti=$GRAFFITI\n      --debug-level=info\n      --suggested-fee-recipient=$FEE_RECIPIENT\n      --metrics\n      --metrics-address=0.0.0.0\n      --metrics-port=5064\n    networks:\n      - gnosis_net\n    ports:\n      - 5064:5064/tcp\n    volumes:\n      - /home/$USER/gnosis/consensus/validators:/data/validators\n      - /etc/timezone:/etc/timezone:ro\n      - /etc/localtime:/etc/localtime:ro\n    logging:\n      driver: "local"\n# highlight-end\n\nnetworks:\n  gnosis_net:\n    name: gnosis_net\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-environment-variables",children:"3. Environment Variables"}),"\n",(0,t.jsxs)(n.p,{children:["Add an ",(0,t.jsx)(n.code,{children:".env"})," file with your fee recipient (your Gnosis address) and graffiti in ",(0,t.jsx)(n.code,{children:"/home/$USER/gnosis/.env"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="/home/$USER/gnosis/.env"',children:"FEE_RECIPIENT=0x0000000000000000000000000000000000000000\nGRAFFITI=gnosischain/lighthouse\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Replace ",(0,t.jsx)(n.code,{children:"suggested-fee-recipient"})," with your Gnosis address. This fee recipient address will receive tips from user transactions from the block the validator proposed. If not set, the tips will be sent to zero address, that is burnt competely. It is strongly recommended that you configure this value in your setup. Learn more about ",(0,t.jsx)(n.a,{href:"https://lighthouse-book.sigmaprime.io/suggested-fee-recipient.html",children:"suggested fee recipient"})," flag in Lighthouse docs."]}),"\n",(0,t.jsxs)(n.p,{children:["Replace ",(0,t.jsx)(n.code,{children:"graffiti"})," with your own ",(0,t.jsx)(n.a,{href:"https://lighthouse-book.sigmaprime.io/graffiti.html",children:"graffiti"}),". It is an optional field that can be used to add a message to the ",(0,t.jsx)(n.a,{href:"https://ethereum.org/en/developers/docs/blocks/",children:"block"})," by the proposer."]}),"\n",(0,t.jsx)(n.h3,{id:"4-keystore-location",children:"4. Keystore Location"}),"\n",(0,t.jsxs)(n.p,{children:["Add your keystores in ",(0,t.jsx)(n.code,{children:"/home/$USER/gnosis/consensus/keystores/"})," and their password in a file ",(0,t.jsx)(n.code,{children:"/home/$USER/gnosis/consensus/keystores/password.txt"})," to get this file structure:"]}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"Note, keystores MUST follow one of these file names"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"keystore-m_12381_3600_[0-9]+_0_0-[0-9]+.json"})," The format exported by the ",(0,t.jsx)(n.code,{children:"eth2.0-deposit-cli"})," library (",(0,t.jsx)(n.a,{href:"https://github.com/sigp/lighthouse/blob/2983235650811437b44199f9c94e517e948a1e9b/common/account_utils/src/validator_definitions.rs#L402",children:"source"}),")"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"keystore-[0-9]+.json"})," The format exported by Prysm (",(0,t.jsx)(n.a,{href:"https://github.com/sigp/lighthouse/blob/2983235650811437b44199f9c94e517e948a1e9b/common/account_utils/src/validator_definitions.rs#L411",children:"source"}),")"]}),"\n"]})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"/home/$USER/gnosis/\n\u251c\u2500\u2500 docker-compose.yml\n\u251c\u2500\u2500 .env\n\u251c\u2500\u2500 jwtsecret/\n\u251c\u2500\u2500 execution/\n\u2514\u2500\u2500 consensus/\n    \u251c\u2500\u2500 data/\n# highlight-start\n    \u251c\u2500\u2500 keystores/\n    \u2502\xa0\xa0 \u251c\u2500\u2500 keystore-001.json\n    \u2502 \xa0\xa0\u251c\u2500\u2500 keystore-002.json\n    \u2502\xa0\xa0 \u2514\u2500\u2500 password.txt\n    \u2514\u2500\u2500 validators/\n# highlight-end\n"})}),"\n",(0,t.jsx)(n.h3,{id:"5-import-keystores",children:"5. Import Keystores"}),"\n",(0,t.jsx)(n.p,{children:"Import your validators:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"docker run \\\n  --rm \\\n  --volume /home/$USER/gnosis/consensus/keystores:/keystores \\\n  --volume /home/$USER/gnosis/consensus:/data sigp/lighthouse:latest-modern lighthouse account validator import \\\n  --network gnosis \\\n  --password-file /keystores/password.txt \\\n  --reuse-password \\\n  --directory /keystores \\\n  --datadir /data\n"})}),"\n",(0,t.jsx)(n.h3,{id:"6-start-containers",children:"6. Start Containers"}),"\n",(0,t.jsx)(n.p,{children:"Start the validator service listed in the compose file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd /home/$USER/gnosis\ndocker-compose up -d\n"})}),"\n",(0,t.jsx)(n.h3,{id:"7-monitor-logs",children:"7. Monitor Logs"}),"\n",(0,t.jsxs)(n.p,{children:["Check your logs for each service (",(0,t.jsx)(n.code,{children:"execution"}),", ",(0,t.jsx)(n.code,{children:"consensus"}),", or ",(0,t.jsx)(n.code,{children:"validator"}),") with:"]}),"\n","\n","\n",(0,t.jsx)(r.Ay,{}),"\n",(0,t.jsx)(n.h3,{id:"8-make-a-deposit",children:"8. Make a Deposit"}),"\n",(0,t.jsx)(n.p,{children:"Make a deposit once your node is fully synced (this can take a few hours depending on setup)."}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"At this stage you should have your EL and CL fully synced and validators must be imported to your CL."})})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.em,{children:["See section ",(0,t.jsx)(n.strong,{children:"Fund Validator"})]})}),"\n",(0,t.jsx)(n.h3,{id:"9-updating-your-node",children:"9. Updating your Node"}),"\n",(0,t.jsx)(n.p,{children:"To update, just pull the new images, then stop and restart your docker-compose file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-shell",children:"cd /home/$USER/gnosis\ndocker-compose pull\ndocker-compose stop\ndocker-compose up -d\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}},7227:(e,n,s)=>{s.d(n,{A:()=>a});s(96540);var t=s(18215);const o={tabItem:"tabItem_Ymn6"};var r=s(74848);function a(e){let{children:n,hidden:s,className:a}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(o.tabItem,a),hidden:s,children:n})}},49489:(e,n,s)=>{s.d(n,{A:()=>k});var t=s(96540),o=s(18215),r=s(24245),a=s(56347),i=s(36494),l=s(62814),c=s(45167),d=s(81269);function u(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:s}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:s,attributes:t,default:o}}=e;return{value:n,label:s,attributes:t,default:o}}))}(s);return function(e){const n=(0,c.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,s])}function m(e){let{value:n,tabValues:s}=e;return s.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:s}=e;const o=(0,a.W6)(),r=function(e){let{queryString:n=!1,groupId:s}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return s??null}({queryString:n,groupId:s});return[(0,l.aZ)(r),(0,t.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(o.location.search);n.set(r,e),o.replace({...o.location,search:n.toString()})}),[r,o])]}function g(e){const{defaultValue:n,queryString:s=!1,groupId:o}=e,r=h(e),[a,l]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:s}=e;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:s}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${s.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=s.find((e=>e.default))??s[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r}))),[c,u]=p({queryString:s,groupId:o}),[g,f]=function(e){let{groupId:n}=e;const s=function(e){return e?`docusaurus.tab.${e}`:null}(n),[o,r]=(0,d.Dv)(s);return[o,(0,t.useCallback)((e=>{s&&r.set(e)}),[s,r])]}({groupId:o}),v=(()=>{const e=c??g;return m({value:e,tabValues:r})?e:null})();(0,i.A)((()=>{v&&l(v)}),[v]);return{selectedValue:a,selectValue:(0,t.useCallback)((e=>{if(!m({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);l(e),u(e),f(e)}),[u,f,r]),tabValues:r}}var f=s(11062);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=s(74848);function j(e){let{className:n,block:s,selectedValue:t,selectValue:a,tabValues:i}=e;const l=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),d=e=>{const n=e.currentTarget,s=l.indexOf(n),o=i[s].value;o!==t&&(c(n),a(o))},u=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const s=l.indexOf(e.currentTarget)+1;n=l[s]??l[0];break}case"ArrowLeft":{const s=l.indexOf(e.currentTarget)-1;n=l[s]??l[l.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":s},n),children:i.map((e=>{let{value:n,label:s,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>l.push(e),onKeyDown:u,onClick:d,...r,className:(0,o.A)("tabs__item",v.tabItem,r?.className,{"tabs__item--active":t===n}),children:s??n},n)}))})}function b(e){let{lazy:n,children:s,selectedValue:o}=e;const r=(Array.isArray(s)?s:[s]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===o));return e?(0,t.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==o})))})}function y(e){const n=g(e);return(0,x.jsxs)("div",{className:(0,o.A)("tabs-container",v.tabList),children:[(0,x.jsx)(j,{...e,...n}),(0,x.jsx)(b,{...e,...n})]})}function k(e){const n=(0,f.A)();return(0,x.jsx)(y,{...e,children:u(e.children)},String(n))}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var t=s(96540);const o={},r=t.createContext(o);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);